webpackJsonp([1],{"CHT+":function(t,i){},NHnr:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=e("O534"),n=e("Sxqw"),l=e.n(n),o={name:"infinite",props:{list:{type:Array,required:!0},size:{type:Number,default:20},loadMore:{type:Function,required:!0},nomore:{type:Boolean,default:!1},showShell:{type:Boolean,default:!0}},data:function(){return{items:[],start:0,height:0,loadings:[]}},computed:{showStart:function(){return Math.max(0,this.start-this.size)},showEnd:function(){return Math.min(this.start+this.size,this.items.length)},showItems:function(){return this.items.slice(Math.max(0,this.start-this.size),Math.min(this.start+this.size,this.items.length))},shellHeight:function(){return this.$refs.shell.offsetHeight},loading:function(){return this.loadings.length},lock:function(){return this.loadings.length>2}},watch:{list:function(t){t.length&&(this.loadings.pop(),this.loading||this.loadItems())},items:function(t){t.length>this.list.length&&this.getItems()},nomore:function(t){var i=this;if(t){var e=this.items.length-this.list.length;this.$nextTick(function(){i.height-=e*i.shellHeight})}}},mounted:function(){this.$el.addEventListener("scroll",this.scrollHandle.bind(this)),this.init()},methods:{init:function(){this.reset(),this.load()},reset:function(){this.items=[],this.$el.scrollTop=0,this.height=0,this.start=0},load:function(){this.items.length+=this.size,this.loadItems()},loadItems:function(){for(var t=this,i=[],e=this.showShell?this.items.length:this.list.length,s=0;s<e;s++)this.items[s]&&this.items[s].loaded||(this.setItem(s,this.list[s]||null),i.push(s));this.$nextTick(function(){i.forEach(function(i){t.updateItemHeight(i)}),t.updateItemTop()})},getItems:function(){this.loadings.push(1),this.loadMore()},setItem:function(t,i){this.$set(this.items,t,{data:i||{},height:0,top:-1e3,shell:!i,loaded:!!i})},updateItemHeight:function(t){var i=this.items[t],e=this.$refs["item"+t];e&&e[0]?i.height=e[0].offsetHeight:i.height=this.shellHeight},updateItemTop:function(){var t=this;this.height=0,this.items.forEach(function(i,e){var s=t.items[e-1];i.top=s?s.top+s.height:0,t.height+=i.height}),this.updateIndex()},updateIndex:function(){for(var t=this.$el.scrollTop,i=0,e=this.items.length;i<e;i++)if(this.items[i].top>=t){this.start=Math.max(0,i-1);break}},scrollHandle:function(){if(this.loading||this.nomore)return this.updateIndex(),!1;var t=this.$el.scrollTop;this.$el.scrollHeight-t-this.$el.offsetHeight<300&&this.load(),this.updateIndex()}}},a={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"infinite"},[e("div",{ref:"list",staticClass:"infinite-list",style:"height: "+t.height+"px"},[t._l(t.showItems,function(i,s){return e("div",{staticClass:"infinite-list-item",style:"transform: translate3d(0, "+i.top+"px, 0)"},[e("div",{staticClass:"infinite-animate infinite-animate-item",style:{opacity:+i.loaded}},[t._t("item",null,{item:i})],2),t._v(" "),e("div",{staticClass:"infinite-animate infinite-animate-shell",style:{opacity:+!i.loaded}},[t._t("shell",null,{item:i})],2)])}),t._v(" "),e("div",{staticClass:"infinite-pool"},[t._l(t.items,function(i,s){return i.shell||i.height?t._e():e("div",{ref:"item"+s,refInFor:!0,staticClass:"infinite-list-item",staticStyle:{visibility:"hidden",top:"-1000px"}},[t._t("item",null,{item:i})],2)}),t._v(" "),e("div",{ref:"shell",staticClass:"vue-recyclist-item",staticStyle:{visibility:"hidden",top:"-1000px"}},[t._t("shell")],2)],2)],2),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.loading&&!t.nomore,expression:"loading && !nomore"}],staticClass:"infinte-loading"},[t._t("loading")],2),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.nomore,expression:"nomore"}],staticClass:"infinite-nomore"},[t._t("nomore")],2),t._v(" "),e("div",{staticClass:"infinite-config"},[e("div",[t._v("list："+t._s(t.list.length))]),t._v(" "),e("div",[t._v("items："+t._s(t.items.length))]),t._v(" "),e("div",[t._v(t._s(t.showStart)+" - "+t._s(t.showEnd))])])])},staticRenderFns:[]};var h={name:"HelloWorld",components:{infinite:e("ngHh")(o,a,!1,function(t){e("CHT+")},"data-v-74b4296a",null).exports},data:function(){return{list:[],size:10,nomore:!1,page:1}},methods:{loadMore:function(){var t=this;setTimeout(function(){for(var i=[],e=0;e<10;e++)i.push({name:"小王"+t.page+"序号"+e,age:parseInt(50*Math.random())});t.list=[].concat(l()(t.list),i),t.page+=1},2e3)}}},r={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"hello"},[e("infinite",{staticClass:"list",attrs:{size:t.size,nomore:t.nomore,list:t.list,loadMore:t.loadMore},scopedSlots:t._u([{key:"item",fn:function(i){return[e("div",{staticClass:"item-wrap"},[e("div",{staticClass:"item-box"},[e("p",[t._v("姓名: "+t._s(i.item.data.name))]),t._v(" "),e("p",[t._v("年龄: "+t._s(i.item.data.age))])])])]}},{key:"shell",fn:function(i){return[e("div",{staticClass:"item-wrap item-shell"},[e("div",{staticClass:"item-box"},[e("p"),t._v(" "),e("p")])])]}}])},[e("template",{slot:"nomore"},[e("p",[t._v("没有更多啦")])]),t._v(" "),e("template",{slot:"loading"},[e("p",[t._v("加载中...")])])],2)],1)},staticRenderFns:[]};var d={name:"app",components:{HelloWorld:e("ngHh")(h,r,!1,function(t){e("xJQq")},"data-v-3d85efe1",null).exports}},c={render:function(){var t=this.$createElement,i=this._self._c||t;return i("div",{attrs:{id:"app"}},[i("h1",[this._v("vue infinite")]),this._v(" "),i("HelloWorld")],1)},staticRenderFns:[]};var m=e("ngHh")(d,c,!1,function(t){e("r0DU")},null,null).exports;s.a.config.productionTip=!1,new s.a({el:"#app",template:"<App/>",components:{App:m}})},r0DU:function(t,i){},xJQq:function(t,i){}},["NHnr"]);
//# sourceMappingURL=app.48b2b693d5f7bab672b7.js.map